# address service listens on, defaults to '127.0.0.1:8080'.
listen_address: 127.0.0.1:8080

# Automatically shutdown when executable changes should only be enabled
# during development. If not specified, defaults to false.
auto_shutdown: false

# Session key is used for encoding cookies for authentication. A new session
# key can be generated by running "gmc genkey" - if a session_key is not
# provided, one will be generated randomly on each startup, but then logins
# won't persist across restarts or work correctly in a cluster configuration.
#
# session_key: 0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f

# Length of time before logins timeout from inactivity (in seconds.)
# Defaults to 86400 (24 hours.)
session_max_age: 86400

# Database configuration.
database:
  type: postgres
  url: postgres://localhost
  # Minimum number of connections to be used by the connection pool.
  # Default is 0, meaning all connections will eventually be freed
  # with none cached.
  min_connections: 0
  # Maximum number of connections to be used by the connection pool.
  # Default is 4 or number of CPUs, whichever is larger.
  max_connections: 4

# The gmcwebapp requires a place to store and reference already stored
# files. "dir" and "s3" types are supported. Only one type of file_store
# can be specified.
file_store:
  # Files are stored in a directory at a specific path.
  type: dir
  path: /storage/gmc

  # Files are stored in an S3 compatible object store.
  type: s3
  # S3 endpoint - name of server to use
  endpoint: localhost:9000
  # S3 use HTTPS?
  secure: false
  # S3 accesskeyid - change this!
  accesskeyid: my_access_key
  # S3 secretaccesskey - change this!
  secretaccesskey: my_secret_access_key
  # S3 bucket name
  bucket: gmc

# Search provider. Only one type of search provider can be specified.
search:
  type: elastic
  url: http://localhost:9200
  user: elastic
  pass: mypassword

# More than one authentication scheme may be configured. In the event of an
# authentication attempt, schemes are tried one at a time in the order
# specified until success, or all schemes have been exhausted.
authentication:
  # Token authentication is used exclusively by the companion Android app.
  # It should typically be specified first, and requires no configuration
  # parameters. Installations not using the Android app can omit the token
  # authentication scheme.
  - type: token

  # File authentication uses a fixed file loaded on startup. The format is
  # apache compatible and uses bcrypt'd passwords. Additional users can be
  # added with the apache htpasswd utility. For example, to create a new
  # password file with the username of 'admin' and the password of 'password':
  #
  # htpasswd -cBb /etc/gmc.passwd admin password
  #
  # To update an existing user:
  #
  # htpasswd -Bb /etc/gmc.passwd admin newpassword
  - type: file
    path: /etc/gmc.passwd

  - type: ldap
    ldap_url: ldap_url
    bind_dn: bind_dn
    bind_password: mypassword
    bind_as_user: true
    disable_certificate_verify: false
    base_dn: base_dn
    user_search: search_filter

  # Always authentication scheme always returns success or
  # failure for any logins. Should only be used for development.
  - type: always
    allow: true
